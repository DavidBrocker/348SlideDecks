# Lab 6: Paired Sample T-Test

## Study Overview

-   **Study Objective:** To investigate if infants can infer social affiliation based on the melody of songs.
-   **Hypothesis:** Infants can recognize familiar melodies and associate them with social group membership.
-   **Experiment Design:** Infants were exposed to a novel lullaby and later observed their looking behavior towards unfamiliar individuals singing either the familiar or an unfamiliar melody.
-   **Reference**: Mehr, S. A., Song, L. A., & Spelke, E. S. (2016). *For 5-month-old infants, melodies are social*. *Psychological Science*, 27, 486-501. [oai_citation_attribution:1â€¡crumplab](https://www.crumplab.com/statisticsLab/lab-6-t-test-one-sample-paired-sample.html?utm_source=chatgpt.com)

## Lab Skills Acquired

-   Conducting paired-samples t-tests.
-   Data visualization techniques.
-   Interpreting statistical results and understanding their limitations.

## Data Analysis Steps

```{r}
#| warning: false
library(dplyr)
library(gt)
```

### 1. Data Preparation

-   **Loading Data**: Download the [dataset](https://raw.githubusercontent.com/CrumpLab/statisticsLab/master/data/MehrSongSpelke2016.csv) in `.csv` format.
-   **Inspecting Data**: Use R functions like `head()` and `summary()` to understand the dataset's structure and contents.

```{r}
# Read in Data
all_data <- 
  read.csv("https://raw.githubusercontent.com/CrumpLab/statisticsLab/master/data/MehrSongSpelke2016.csv")

# Preview of Data
all_data |> 
  gt_preview()

```

### 2. Baseline Phase: One-Sample t-Test

-   **Purpose**: Determine if infants' gaze proportions during the baseline (silent) phase differ from chance level (0.5).
-   **Procedure**:
    -   Visualize data distribution using `plot()` and `hist()` functions.
    -   Calculate descriptive statistics: mean and standard deviation.
    -   Perform a one-sample t-test comparing the mean gaze proportion to 0.5.
-   **Baseline Trial Design:** Infants watched a 16-second silent video of two unfamiliar people smiling directly at them.
-   **Looking Time Analysis:** The proportion of time infants looked at the person who would later sing a familiar song was analyzed to determine if there was a bias.
-   **Statistical Test:** A one-sample t-test was used to determine if the average proportion of looking time was significantly different from .5.

::: panel-tabset
## Scatterplot

```{r}
library(ggplot2)
# Filter Data from Experiment 1
exp_1 <- 
  all_data |> 
  filter(exp1==1)

exp_1 |> 
  select(Baseline_Proportion_Gaze_to_Singer) |> 
  ggplot(aes(y = Baseline_Proportion_Gaze_to_Singer,
             x = 1:length(Baseline_Proportion_Gaze_to_Singer))) + 
  geom_point() + 
  theme_minimal() +
  labs(
    x = "\nIndex",
    y = "Baseline\n"
  ) + 
  theme(
    panel.grid = element_blank()
  ) + 
  geom_hline(
    aes(
      yintercept = mean(Baseline_Proportion_Gaze_to_Singer)),
      lty = "dashed"
      )
```

## Histogram

```{r}
library(ggplot2)
# Filter Data from Experiment 1
exp_1 <- 
  all_data |> 
  filter(exp1==1)

exp_1 |> 
  select(Baseline_Proportion_Gaze_to_Singer) |> 
  ggplot(aes(x = Baseline_Proportion_Gaze_to_Singer)) + 
  geom_histogram(
    bins = 8,
    breaks = c(0.2 ,0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9),
    fill = "lightblue",
    color = "black"
  ) +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  ) +
  labs(
    x = "\nBaseline",
    y = "Frequency\n"
  )
```
:::

The mean of the Baseline Proportion is .521 and the standard deviation is .176. what do we think this means for our overall finding?

```{r}
t.test(exp_1$Baseline_Proportion_Gaze_to_Singer, mu = .5) |> 
  broom::tidy() |> 
    rename(
    `Mean Estimate` = estimate,
    `t-Statistic` = statistic,
    `p-Value` = p.value,
    `Degrees of Freedom` = parameter,
    `95% CI Lower` = conf.low,
    `95% CI Upper` = conf.high,
    `Test Type` = method,
    `Tail Direction` = alternative
  ) |> 
 gt()
```

> The average proportion looking time toward the singer was .52, and was not significantly different from .5, according to a one-sample test, t(31) = .67, p = .505

### 3. Test Phase: Paired-Samples t-Test

-   **Purpose**: Assess if infants' gaze proportions differ between two conditions: when the singer is on the left versus the right.
-   **Procedure**:
    -   Compute difference scores between the two conditions.
    -   Visualize the difference scores.
    -   Conduct a paired-samples t-test on the difference scores.
-   **Experiment Procedure**: Infants watched silent videos of two women, then listened to one woman sing a familiar song and the other an unfamiliar song. Finally, they watched the silent videos again.
-   **Hypothesis**: Infants would look more at the woman who sang the familiar song.
-   **Data Analysis**: A one-sample t-test will be conducted using existing code to determine if infants looked at the familiar singer for more than 50% of the time.

::: panel-tabset
## Test - Scatterplot

```{r}
library(ggplot2)
# Filter Data from Experiment 1
exp_1 <- 
  all_data |> 
  filter(exp1==1)

exp_1 |> 
  select(Test_Proportion_Gaze_to_Singer) |> 
  ggplot(aes(y = Test_Proportion_Gaze_to_Singer,
             x = 1:length(Test_Proportion_Gaze_to_Singer))) + 
  geom_point() + 
  theme_minimal() +
  labs(
    x = "\nIndex",
    y = "Baseline\n"
  ) + 
  theme(
    panel.grid = element_blank()
  ) + 
  geom_hline(
    aes(
      yintercept = mean(Test_Proportion_Gaze_to_Singer)),
      lty = "dashed"
      )
```

## Test - Histogram

```{r}
exp_1 <- 
  all_data |> 
  filter(exp1==1)

exp_1 |> 
  select(Test_Proportion_Gaze_to_Singer) |> 
  ggplot(aes(x = Test_Proportion_Gaze_to_Singer)) + 
  geom_histogram(
    bins = 8,
    breaks = c(0.2 ,0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9),
    fill = "lightblue",
    color = "black"
  ) +
  theme_minimal() +
  theme(
    panel.grid = element_blank()
  ) +
  labs(
    x = "\nBaseline",
    y = "Frequency\n"
  )
```
:::

The mean for the looking duration is .593 and the standard deviation is .17. What do you think will happen?

```{r}

t.test(exp_1$Test_Proportion_Gaze_to_Singer, mu = .5) |> 
    broom::tidy() |> 
    rename(
    `Mean Estimate` = estimate,
    `t-Statistic` = statistic,
    `p-Value` = p.value,
    `Degrees of Freedom` = parameter,
    `95% CI Lower` = conf.low,
    `95% CI Upper` = conf.high,
    `Test Type` = method,
    `Tail Direction` = alternative
  ) |> 
 gt()
```

> The average proportion looking time toward the singer was .59, and was significantly different from .5, according to a one-sample test, t(31) = 2.95, p = .005

## Combining Baseline and Testing Phase

```{r}
t.test(exp_1$Test_Proportion_Gaze_to_Singer, exp_1$Baseline_Proportion_Gaze_to_Singer,
       paired = TRUE,
       var.equal = TRUE) |> 
  broom::tidy() |> 
  rename(
    `Mean Difference` = estimate,
    `t-Statistic` = statistic,
    `p-Value` = p.value,
    `Degrees of Freedom` = parameter,
    `95% CI Lower` = conf.low,
    `95% CI Upper` = conf.high,
    `Test Type` = method,
    `Tail Direction` = alternative
  ) |> 
  gt()
```

## Visually Showing the Differences

```{r}

tibble(
  phase = rep(c("Baseline","Test"), each = 32),
  proportions = c(exp_1$Baseline_Proportion_Gaze_to_Singer,
                  exp_1$Test_Proportion_Gaze_to_Singer)
  ) |> 
  ggplot(aes(phase, proportions)) + 
  stat_summary(
    fun = mean,
    geom = "bar",
    aes(fill = phase)
  ) +
  geom_point(
    alpha = .25
  ) +
  stat_summary(
    fun.data = "mean_se",
    geom = "errorbar",
    width = .1
  ) + 
  theme_minimal()
```
